{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\PokeStore\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{connect}from'react-redux';import{FaSpinner}from'react-icons/fa';import swal from'@sweetalert/with-react';import{Container,Loading,Pagination}from'./style';import{getPokemonsOfType}from'../services/PokemonService';import Cart from'../components/Cart';import ProductList from'../components/ProductList';var Checkout=/*#__PURE__*/function(_Component){_inherits(Checkout,_Component);var _super=_createSuper(Checkout);function Checkout(){var _this;_classCallCheck(this,Checkout);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={pokemons:[],pokemonsView:[],currentPage:1,pokemonsPerPage:6,searchedPokemon:null,loading:true};_this.handleNextPage=function(){var _this$state=_this.state,currentPage=_this$state.currentPage,pokemons=_this$state.pokemons,pokemonsPerPage=_this$state.pokemonsPerPage;var lastPage=Math.ceil(pokemons.length/pokemonsPerPage);var newPage=currentPage===lastPage?lastPage:currentPage+1;_this.setNewPagination(newPage);};_this.handlePreviousPage=function(){var currentPage=_this.state.currentPage;var newPage=currentPage===1?1:currentPage-1;_this.setNewPagination(newPage);};return _this;}_createClass(Checkout,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state2,pokemons,currentPage,pokemonsPerPage,theme,items,indexOfLastPokemon,indexOfFirstPokemon,pokemonsView;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state2=this.state,pokemons=_this$state2.pokemons,currentPage=_this$state2.currentPage,pokemonsPerPage=_this$state2.pokemonsPerPage;theme=this.props.theme;items=JSON.parse(sessionStorage.getItem('pokemons'));if(items){_context.next=14;break;}_context.prev=4;_context.next=7;return getPokemonsOfType(theme.theme);case 7:items=_context.sent;_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](4);swal({text:'Não foi possível capturar todos os Pokemon, por favor, atualize a página e tente novamente',buttons:{cancel:'Close'}});return _context.abrupt(\"return\");case 14:indexOfLastPokemon=currentPage*pokemonsPerPage;indexOfFirstPokemon=indexOfLastPokemon-pokemonsPerPage;pokemonsView=items.slice(indexOfFirstPokemon,indexOfLastPokemon);this.setState({pokemons:[].concat(_toConsumableArray(pokemons),_toConsumableArray(items)),loading:false,pokemonsView:_toConsumableArray(pokemonsView)});case 18:case\"end\":return _context.stop();}}},_callee,this,[[4,10]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var searchText=this.props.searchText;var pokemons=this.state.pokemons;if(prevState.pokemons!==pokemons){sessionStorage.setItem('pokemons',JSON.stringify(pokemons));}if(prevProps.searchText!==searchText){var searched=null;if(searchText!==''){searched=pokemons.filter(function(pokemon){return pokemon.name.toLowerCase().startsWith(searchText);});}this.setState({searchedPokemon:searched?_toConsumableArray(searched):null});}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){sessionStorage.clear();}},{key:\"setNewPagination\",value:function setNewPagination(newPage){var _this$state3=this.state,pokemons=_this$state3.pokemons,pokemonsPerPage=_this$state3.pokemonsPerPage;var indexOfFirstPokemon=(newPage-1)*pokemonsPerPage;var indexOfLastPokemon=indexOfFirstPokemon+pokemonsPerPage;var newSet=pokemons.slice(indexOfFirstPokemon,indexOfLastPokemon);this.setState({pokemonsView:_toConsumableArray(newSet),currentPage:newPage});}},{key:\"render\",value:function render(){var _this2=this;var _this$state4=this.state,pokemonsView=_this$state4.pokemonsView,searchedPokemon=_this$state4.searchedPokemon,loading=_this$state4.loading;var theme=this.props.theme;if(loading){return/*#__PURE__*/React.createElement(Loading,null,/*#__PURE__*/React.createElement(FaSpinner,{size:50,color:\"#fff\"},\"Carregando\"));}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(ProductList,{pokemons:searchedPokemon||pokemonsView}),/*#__PURE__*/React.createElement(Cart,null)),/*#__PURE__*/React.createElement(Pagination,{theme:theme.color},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this2.handlePreviousPage();}},/*#__PURE__*/React.createElement(\"span\",null,\"Retroceder\")),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this2.handleNextPage();}},/*#__PURE__*/React.createElement(\"span\",null,\"Avan\\xE7ar\"))));}}]);return Checkout;}(Component);var mapStateToProps=function mapStateToProps(state){return{searchText:state.productList,theme:state.theme};};export default connect(mapStateToProps)(Checkout);","map":{"version":3,"sources":["C:/Users/User/Documents/GitHub/PokeStore/src/pages/index.js"],"names":["React","Component","connect","FaSpinner","swal","Container","Loading","Pagination","getPokemonsOfType","Cart","ProductList","Checkout","state","pokemons","pokemonsView","currentPage","pokemonsPerPage","searchedPokemon","loading","handleNextPage","lastPage","Math","ceil","length","newPage","setNewPagination","handlePreviousPage","theme","props","items","JSON","parse","sessionStorage","getItem","text","buttons","cancel","indexOfLastPokemon","indexOfFirstPokemon","slice","setState","prevProps","prevState","searchText","setItem","stringify","searched","filter","pokemon","name","toLowerCase","startsWith","clear","newSet","color","mapStateToProps","productList"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { FaSpinner } from 'react-icons/fa';\r\nimport swal from '@sweetalert/with-react';\r\nimport { Container, Loading, Pagination } from './style';\r\nimport { getPokemonsOfType } from '../services/PokemonService';\r\nimport Cart from '../components/Cart';\r\nimport ProductList from '../components/ProductList';\r\n\r\nclass Checkout extends Component {\r\n  state = {\r\n    pokemons: [],\r\n    pokemonsView: [],\r\n    currentPage: 1,\r\n    pokemonsPerPage: 6,\r\n    searchedPokemon: null,\r\n    loading: true,\r\n  };\r\n\r\n  async componentDidMount() {\r\n    const { pokemons, currentPage, pokemonsPerPage } = this.state;\r\n    const { theme } = this.props;\r\n\r\n    let items = JSON.parse(sessionStorage.getItem('pokemons'));\r\n\r\n    if (!items) {\r\n      try {\r\n        items = await getPokemonsOfType(theme.theme);\r\n      } catch (error) {\r\n        swal({\r\n          text:\r\n            'Não foi possível capturar todos os Pokemon, por favor, atualize a página e tente novamente',\r\n          buttons: {\r\n            cancel: 'Close',\r\n          },\r\n        });\r\n        return;\r\n      }\r\n    }\r\n\r\n    const indexOfLastPokemon = currentPage * pokemonsPerPage;\r\n    const indexOfFirstPokemon = indexOfLastPokemon - pokemonsPerPage;\r\n    const pokemonsView = items.slice(indexOfFirstPokemon, indexOfLastPokemon);\r\n\r\n    this.setState({\r\n      pokemons: [...pokemons, ...items],\r\n      loading: false,\r\n      pokemonsView: [...pokemonsView],\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const { searchText } = this.props;\r\n    const { pokemons } = this.state;\r\n\r\n    if (prevState.pokemons !== pokemons) {\r\n      sessionStorage.setItem('pokemons', JSON.stringify(pokemons));\r\n    }\r\n\r\n    if (prevProps.searchText !== searchText) {\r\n      let searched = null;\r\n\r\n      if (searchText !== '') {\r\n        searched = pokemons.filter((pokemon) =>\r\n          pokemon.name.toLowerCase().startsWith(searchText)\r\n        );\r\n      }\r\n\r\n      this.setState({\r\n        searchedPokemon: searched ? [...searched] : null,\r\n      });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    sessionStorage.clear();\r\n  }\r\n\r\n  setNewPagination(newPage) {\r\n    const { pokemons, pokemonsPerPage } = this.state;\r\n\r\n    const indexOfFirstPokemon = (newPage - 1) * pokemonsPerPage;\r\n    const indexOfLastPokemon = indexOfFirstPokemon + pokemonsPerPage;\r\n    const newSet = pokemons.slice(indexOfFirstPokemon, indexOfLastPokemon);\r\n\r\n    this.setState({\r\n      pokemonsView: [...newSet],\r\n      currentPage: newPage,\r\n    });\r\n  }\r\n\r\n  handleNextPage = () => {\r\n    const { currentPage, pokemons, pokemonsPerPage } = this.state;\r\n    const lastPage = Math.ceil(pokemons.length / pokemonsPerPage);\r\n    const newPage = currentPage === lastPage ? lastPage : currentPage + 1;\r\n    this.setNewPagination(newPage);\r\n  };\r\n\r\n  handlePreviousPage = () => {\r\n    const { currentPage } = this.state;\r\n    const newPage = currentPage === 1 ? 1 : currentPage - 1;\r\n    this.setNewPagination(newPage);\r\n  };\r\n\r\n  render() {\r\n    const { pokemonsView, searchedPokemon, loading } = this.state;\r\n    const { theme } = this.props;\r\n\r\n    if (loading) {\r\n      return (\r\n        <Loading>\r\n          <FaSpinner size={50} color=\"#fff\">\r\n            Carregando\r\n          </FaSpinner>\r\n        </Loading>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <Container>\r\n          <ProductList pokemons={searchedPokemon || pokemonsView} />\r\n          <Cart />\r\n        </Container>\r\n        <Pagination theme={theme.color}>\r\n          <button type=\"button\" onClick={() => this.handlePreviousPage()}>\r\n            <span>Retroceder</span>\r\n          </button>\r\n          <button type=\"button\" onClick={() => this.handleNextPage()}>\r\n            <span>Avançar</span>\r\n          </button>\r\n        </Pagination>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  searchText: state.productList,\r\n  theme: state.theme,\r\n});\r\n\r\nexport default connect(mapStateToProps)(Checkout);"]},"metadata":{},"sourceType":"module"}